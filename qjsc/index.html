{"layout":"false","_content":"\n<!DOCTYPE html>\n<html lang=\"zh\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"\n    />\n    <title>公寓岗小助手</title>\n    <style>\n      * {\n        box-sizing: border-box;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      body {\n        font-family: system-ui, -apple-system, sans-serif;\n        margin: 0;\n        padding: 16px;\n        background-color: #f5f5f5;\n        font-size: 16px;\n      }\n\n      .container {\n        max-width: 600px;\n        margin: 0 auto;\n        background-color: #ffffff;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      /* 新增常用链接样式 */\n      .quick-links {\n        display: flex;\n        gap: 12px;\n        margin-bottom: 24px;\n      }\n\n      .quick-link-btn {\n        flex: 1;\n        padding: 14px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        background-color: #2196f3;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n\n      .quick-link-btn:active {\n        background-color: #1976d2;\n      }\n\n      h2 {\n        text-align: center;\n        margin: 0 0 24px 0;\n        color: #333;\n        font-size: 1.5rem;\n      }\n\n      .form-group {\n        margin-bottom: 20px;\n      }\n\n      .time-group {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n      }\n\n      .time-group span {\n        color: #666;\n        font-weight: 600;\n      }\n\n      .time-input {\n        flex: 1;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        background-color: #fff;\n      }\n\n      .time-input:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      label {\n        display: block;\n        margin-bottom: 8px;\n        font-weight: 600;\n        color: #444;\n        font-size: 1rem;\n      }\n\n      select,\n      input {\n        width: 100%;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        appearance: none;\n        -webkit-appearance: none;\n        background-color: #fff;\n      }\n\n      select {\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n        background-repeat: no-repeat;\n        background-position: right 12px center;\n        background-size: 16px;\n        padding-right: 40px;\n      }\n\n      input:focus,\n      select:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      #date {\n        background-color: #f8f8f8;\n        color: #666;\n      }\n\n      .button-group {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        margin-top: 24px;\n      }\n\n      button {\n        width: 100%;\n        padding: 16px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        cursor: pointer;\n        transition: all 0.2s;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      .generate-btn {\n        background-color: #2196f3;\n      }\n\n      .generate-btn:active {\n        background-color: #1976d2;\n      }\n\n      .copy-button {\n        background-color: #4caf50;\n      }\n\n      .copy-button:active {\n        background-color: #45a049;\n      }\n\n      .position-grid {\n        display: grid;\n        grid-template-columns: repeat(6, 1fr);\n        gap: 8px;\n        margin-top: 8px;\n      }\n\n      .position-btn {\n        padding: 12px 4px;\n        background-color: #f0f0f0;\n        color: #333;\n        font-size: 0.9rem;\n        font-weight: normal;\n      }\n\n      .position-btn.selected {\n        background-color: #2196f3;\n        color: white;\n      }\n\n      .result {\n        margin-top: 24px;\n        padding: 16px;\n        background-color: #f8f8f8;\n        border-radius: 8px;\n        word-break: break-all;\n      }\n\n      .result p {\n        margin: 8px 0;\n        line-height: 1.5;\n      }\n\n      .result p:last-child {\n        font-size: 1.1rem;\n        font-weight: 600;\n        color: #333;\n      }\n\n      .fixed-bottom {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 12px 16px;\n        background-color: #fff;\n        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      .bottom-spacing {\n        height: 80px;\n      }\n\n      .selected-position {\n        margin-top: 12px;\n        padding: 8px;\n        background-color: #e3f2fd;\n        border-radius: 4px;\n        text-align: center;\n        font-weight: bold;\n        color: #1976d2;\n      }\n\n      #tempTimeGroup {\n        display: none;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"container\">\n      <h2>主管常用表格</h2>\n\n      <!-- 新增常用链接栏目 -->\n      <div class=\"quick-links\">\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVUhRTGJKS3hTdkFx'\"\n        >\n          排班表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS2poZEhocEFEb1pS?tab=zwbgiy'\"\n        >\n          空岗表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVVpLd0ZTRnhLa1Fz'\"\n        >\n          裸辞表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS0pWdlRvRkl0bG5Q'\"\n        >\n          黑名单\n        </button>\n      </div>\n      <h2>请假信息生成器</h2>\n      <div class=\"form-group\">\n        <label>日期标记</label>\n        <select id=\"datePrefix\" onchange=\"updateDate()\">\n          <option value=\"今天\">今天</option>\n          <option value=\"明天\">明天</option>\n          <option value=\"后天\">后天</option>\n          <option value=\"本周一\">周一</option>\n          <option value=\"本周二\">周二</option>\n          <option value=\"本周三\">周三</option>\n          <option value=\"本周四\">周四</option>\n          <option value=\"本周五\">周五</option>\n          <option value=\"本周六\">周六</option>\n          <option value=\"本周日\">周日</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>具体日期</label>\n        <input type=\"text\" id=\"date\" readonly />\n      </div>\n      <div class=\"form-group\">\n        <label>班次</label>\n        <select id=\"shift\">\n          <option value=\"早班\">早班</option>\n          <option value=\"午班\">午班</option>\n          <option value=\"晚班\">晚班</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>楼栋号</label>\n        <div id=\"position-grid\" class=\"position-grid\"></div>\n        <div id=\"selected-position\" class=\"selected-position\">请选择楼栋号</div>\n      </div>\n      <div class=\"form-group\">\n        <label>姓名</label>\n        <input type=\"text\" id=\"name\" placeholder=\"请输入姓名\" />\n      </div>\n      <div class=\"form-group\">\n        <label>请假类型</label>\n        <select id=\"leaveType\" onchange=\"toggleTempTimeGroup()\">\n          <option value=\"请假\">请假</option>\n          <option value=\"请假不当\">请假不当</option>\n          <option value=\"接班\">接班</option>\n          <option value=\"临时请假\">临时请假</option>\n        </select>\n      </div>\n      <div id=\"tempTimeGroup\" class=\"form-group\">\n        <label>临时请假时间</label>\n        <div class=\"time-group\">\n          <input type=\"time\" id=\"startTime\" class=\"time-input\" />\n          <span>至</span>\n          <input type=\"time\" id=\"endTime\" class=\"time-input\" />\n        </div>\n      </div>\n      <div id=\"result\"></div>\n      <div class=\"bottom-spacing\"></div>\n    </div>\n\n    <div class=\"fixed-bottom\">\n      <div class=\"button-group\">\n        <button class=\"generate-btn\" onclick=\"generateMessage()\">\n          生成请假信息\n        </button>\n      </div>\n    </div>\n\n    <script>\n      let selectedPosition = \"\";\n\n      function initializePositionGrid() {\n        const grid = document.getElementById(\"position-grid\");\n        for (let i = 1; i <= 27; i++) {\n          if (i === 5) {\n            const buttonA = document.createElement(\"button\");\n            const buttonB = document.createElement(\"button\");\n            buttonA.textContent = \"5A#\";\n            buttonB.textContent = \"5B#\";\n            buttonA.className = \"position-btn\";\n            buttonB.className = \"position-btn\";\n            buttonA.onclick = () => selectPosition(\"5A#\");\n            buttonB.onclick = () => selectPosition(\"5B#\");\n            grid.appendChild(buttonA);\n            grid.appendChild(buttonB);\n          } else {\n            const button = document.createElement(\"button\");\n            button.textContent = `${i}#`;\n            button.className = \"position-btn\";\n            button.onclick = () => selectPosition(`${i}#`);\n            grid.appendChild(button);\n          }\n        }\n      }\n\n      function toggleTempTimeGroup() {\n        const leaveType = document.getElementById(\"leaveType\").value;\n        const tempTimeGroup = document.getElementById(\"tempTimeGroup\");\n        tempTimeGroup.style.display =\n          leaveType === \"临时请假\" ? \"block\" : \"none\";\n      }\n\n      function selectPosition(position) {\n        selectedPosition = position;\n        document.querySelectorAll(\".position-btn\").forEach((btn) => {\n          btn.classList.remove(\"selected\");\n          if (btn.textContent === position) {\n            btn.classList.add(\"selected\");\n          }\n        });\n        document.getElementById(\n          \"selected-position\"\n        ).textContent = `已选择: ${position}`;\n      }\n\n      function getDateOfWeek(dayName) {\n        const days = {\n          本周一: 1,\n          本周二: 2,\n          本周三: 3,\n          本周四: 4,\n          本周五: 5,\n          本周六: 6,\n          本周日: 0,\n        };\n\n        const today = new Date();\n        const currentDay = today.getDay();\n        const targetDay = days[dayName];\n\n        let diff = targetDay - currentDay;\n        if (targetDay === 0) diff = 7 - currentDay;\n        if (diff <= 0) diff += 7;\n\n        const targetDate = new Date(today);\n        targetDate.setDate(today.getDate() + diff);\n\n        return `${targetDate.getMonth() + 1}.${targetDate.getDate()}`;\n      }\n\n      function getDateByOffset(offset) {\n        const date = new Date();\n        date.setDate(date.getDate() + offset);\n        return `${date.getMonth() + 1}.${date.getDate()}`;\n      }\n\n      function updateDate() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        let dateStr;\n\n        if (datePrefix.startsWith(\"本周\")) {\n          dateStr = getDateOfWeek(datePrefix);\n        } else {\n          const offset =\n            datePrefix === \"明天\" ? 1 : datePrefix === \"后天\" ? 2 : 0;\n          dateStr = getDateByOffset(offset);\n        }\n\n        document.getElementById(\"date\").value = dateStr;\n      }\n\n      function calculateTimeDifference(start, end) {\n        const [startHours, startMinutes] = start.split(\":\").map(Number);\n        const [endHours, endMinutes] = end.split(\":\").map(Number);\n\n        let diffMinutes =\n          endHours * 60 + endMinutes - (startHours * 60 + startMinutes);\n\n        // 如果结束时间小于开始时间，假设跨天，加24小时\n        if (diffMinutes < 0) {\n          diffMinutes += 24 * 60;\n        }\n\n        return diffMinutes;\n      }\n\n      function generateMessage() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        const date = document.getElementById(\"date\").value;\n        const shift = document.getElementById(\"shift\").value;\n        const name = document.getElementById(\"name\").value;\n        const leaveType = document.getElementById(\"leaveType\").value;\n\n        if (!selectedPosition || !name) {\n          alert(\"请填写完整信息！\");\n          return;\n        }\n\n        let message = `请假：${datePrefix}（${date}）${shift} ${selectedPosition} ${name} ${leaveType}`;\n\n        if (leaveType === \"临时请假\") {\n          const startTime = document.getElementById(\"startTime\").value;\n          const endTime = document.getElementById(\"endTime\").value;\n          if (!startTime || !endTime) {\n            alert(\"请填写临时请假时间！\");\n            return;\n          }\n          const diffMinutes = calculateTimeDifference(startTime, endTime);\n          message += ` ${diffMinutes}mins (${startTime}-${endTime})`;\n        }\n\n        const resultDiv = document.getElementById(\"result\");\n        resultDiv.innerHTML = `\n          <div class=\"result\">\n            <p>生成的信息：</p>\n            <p>${message}</p>\n          </div>\n          <div class=\"button-group\">\n            <button onclick=\"copyToClipboard('${message}')\" class=\"copy-button\">复制到剪贴板</button>\n          </div>\n        `;\n\n        resultDiv.scrollIntoView({ behavior: \"smooth\" });\n      }\n\n      function copyToClipboard(text) {\n        navigator.clipboard\n          .writeText(text)\n          .then(() => {\n            alert(\"已复制到剪贴板！\");\n          })\n          .catch((err) => {\n            alert(\"复制失败，请手动复制。\");\n            console.error(\"复制失败:\", err);\n          });\n      }\n\n      window.onload = function () {\n        updateDate();\n        initializePositionGrid();\n        toggleTempTimeGroup();\n      };\n    </script>\n  </body>\n</html>\n","source":"qjsc/index.html","raw":"---\nlayout: false\n---\n\n<!DOCTYPE html>\n<html lang=\"zh\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"\n    />\n    <title>公寓岗小助手</title>\n    <style>\n      * {\n        box-sizing: border-box;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      body {\n        font-family: system-ui, -apple-system, sans-serif;\n        margin: 0;\n        padding: 16px;\n        background-color: #f5f5f5;\n        font-size: 16px;\n      }\n\n      .container {\n        max-width: 600px;\n        margin: 0 auto;\n        background-color: #ffffff;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      /* 新增常用链接样式 */\n      .quick-links {\n        display: flex;\n        gap: 12px;\n        margin-bottom: 24px;\n      }\n\n      .quick-link-btn {\n        flex: 1;\n        padding: 14px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        background-color: #2196f3;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n\n      .quick-link-btn:active {\n        background-color: #1976d2;\n      }\n\n      h2 {\n        text-align: center;\n        margin: 0 0 24px 0;\n        color: #333;\n        font-size: 1.5rem;\n      }\n\n      .form-group {\n        margin-bottom: 20px;\n      }\n\n      .time-group {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n      }\n\n      .time-group span {\n        color: #666;\n        font-weight: 600;\n      }\n\n      .time-input {\n        flex: 1;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        background-color: #fff;\n      }\n\n      .time-input:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      label {\n        display: block;\n        margin-bottom: 8px;\n        font-weight: 600;\n        color: #444;\n        font-size: 1rem;\n      }\n\n      select,\n      input {\n        width: 100%;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        appearance: none;\n        -webkit-appearance: none;\n        background-color: #fff;\n      }\n\n      select {\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n        background-repeat: no-repeat;\n        background-position: right 12px center;\n        background-size: 16px;\n        padding-right: 40px;\n      }\n\n      input:focus,\n      select:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      #date {\n        background-color: #f8f8f8;\n        color: #666;\n      }\n\n      .button-group {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        margin-top: 24px;\n      }\n\n      button {\n        width: 100%;\n        padding: 16px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        cursor: pointer;\n        transition: all 0.2s;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      .generate-btn {\n        background-color: #2196f3;\n      }\n\n      .generate-btn:active {\n        background-color: #1976d2;\n      }\n\n      .copy-button {\n        background-color: #4caf50;\n      }\n\n      .copy-button:active {\n        background-color: #45a049;\n      }\n\n      .position-grid {\n        display: grid;\n        grid-template-columns: repeat(6, 1fr);\n        gap: 8px;\n        margin-top: 8px;\n      }\n\n      .position-btn {\n        padding: 12px 4px;\n        background-color: #f0f0f0;\n        color: #333;\n        font-size: 0.9rem;\n        font-weight: normal;\n      }\n\n      .position-btn.selected {\n        background-color: #2196f3;\n        color: white;\n      }\n\n      .result {\n        margin-top: 24px;\n        padding: 16px;\n        background-color: #f8f8f8;\n        border-radius: 8px;\n        word-break: break-all;\n      }\n\n      .result p {\n        margin: 8px 0;\n        line-height: 1.5;\n      }\n\n      .result p:last-child {\n        font-size: 1.1rem;\n        font-weight: 600;\n        color: #333;\n      }\n\n      .fixed-bottom {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 12px 16px;\n        background-color: #fff;\n        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      .bottom-spacing {\n        height: 80px;\n      }\n\n      .selected-position {\n        margin-top: 12px;\n        padding: 8px;\n        background-color: #e3f2fd;\n        border-radius: 4px;\n        text-align: center;\n        font-weight: bold;\n        color: #1976d2;\n      }\n\n      #tempTimeGroup {\n        display: none;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"container\">\n      <h2>主管常用表格</h2>\n\n      <!-- 新增常用链接栏目 -->\n      <div class=\"quick-links\">\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVUhRTGJKS3hTdkFx'\"\n        >\n          排班表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS2poZEhocEFEb1pS?tab=zwbgiy'\"\n        >\n          空岗表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVVpLd0ZTRnhLa1Fz'\"\n        >\n          裸辞表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS0pWdlRvRkl0bG5Q'\"\n        >\n          黑名单\n        </button>\n      </div>\n      <h2>请假信息生成器</h2>\n      <div class=\"form-group\">\n        <label>日期标记</label>\n        <select id=\"datePrefix\" onchange=\"updateDate()\">\n          <option value=\"今天\">今天</option>\n          <option value=\"明天\">明天</option>\n          <option value=\"后天\">后天</option>\n          <option value=\"本周一\">周一</option>\n          <option value=\"本周二\">周二</option>\n          <option value=\"本周三\">周三</option>\n          <option value=\"本周四\">周四</option>\n          <option value=\"本周五\">周五</option>\n          <option value=\"本周六\">周六</option>\n          <option value=\"本周日\">周日</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>具体日期</label>\n        <input type=\"text\" id=\"date\" readonly />\n      </div>\n      <div class=\"form-group\">\n        <label>班次</label>\n        <select id=\"shift\">\n          <option value=\"早班\">早班</option>\n          <option value=\"午班\">午班</option>\n          <option value=\"晚班\">晚班</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>楼栋号</label>\n        <div id=\"position-grid\" class=\"position-grid\"></div>\n        <div id=\"selected-position\" class=\"selected-position\">请选择楼栋号</div>\n      </div>\n      <div class=\"form-group\">\n        <label>姓名</label>\n        <input type=\"text\" id=\"name\" placeholder=\"请输入姓名\" />\n      </div>\n      <div class=\"form-group\">\n        <label>请假类型</label>\n        <select id=\"leaveType\" onchange=\"toggleTempTimeGroup()\">\n          <option value=\"请假\">请假</option>\n          <option value=\"请假不当\">请假不当</option>\n          <option value=\"接班\">接班</option>\n          <option value=\"临时请假\">临时请假</option>\n        </select>\n      </div>\n      <div id=\"tempTimeGroup\" class=\"form-group\">\n        <label>临时请假时间</label>\n        <div class=\"time-group\">\n          <input type=\"time\" id=\"startTime\" class=\"time-input\" />\n          <span>至</span>\n          <input type=\"time\" id=\"endTime\" class=\"time-input\" />\n        </div>\n      </div>\n      <div id=\"result\"></div>\n      <div class=\"bottom-spacing\"></div>\n    </div>\n\n    <div class=\"fixed-bottom\">\n      <div class=\"button-group\">\n        <button class=\"generate-btn\" onclick=\"generateMessage()\">\n          生成请假信息\n        </button>\n      </div>\n    </div>\n\n    <script>\n      let selectedPosition = \"\";\n\n      function initializePositionGrid() {\n        const grid = document.getElementById(\"position-grid\");\n        for (let i = 1; i <= 27; i++) {\n          if (i === 5) {\n            const buttonA = document.createElement(\"button\");\n            const buttonB = document.createElement(\"button\");\n            buttonA.textContent = \"5A#\";\n            buttonB.textContent = \"5B#\";\n            buttonA.className = \"position-btn\";\n            buttonB.className = \"position-btn\";\n            buttonA.onclick = () => selectPosition(\"5A#\");\n            buttonB.onclick = () => selectPosition(\"5B#\");\n            grid.appendChild(buttonA);\n            grid.appendChild(buttonB);\n          } else {\n            const button = document.createElement(\"button\");\n            button.textContent = `${i}#`;\n            button.className = \"position-btn\";\n            button.onclick = () => selectPosition(`${i}#`);\n            grid.appendChild(button);\n          }\n        }\n      }\n\n      function toggleTempTimeGroup() {\n        const leaveType = document.getElementById(\"leaveType\").value;\n        const tempTimeGroup = document.getElementById(\"tempTimeGroup\");\n        tempTimeGroup.style.display =\n          leaveType === \"临时请假\" ? \"block\" : \"none\";\n      }\n\n      function selectPosition(position) {\n        selectedPosition = position;\n        document.querySelectorAll(\".position-btn\").forEach((btn) => {\n          btn.classList.remove(\"selected\");\n          if (btn.textContent === position) {\n            btn.classList.add(\"selected\");\n          }\n        });\n        document.getElementById(\n          \"selected-position\"\n        ).textContent = `已选择: ${position}`;\n      }\n\n      function getDateOfWeek(dayName) {\n        const days = {\n          本周一: 1,\n          本周二: 2,\n          本周三: 3,\n          本周四: 4,\n          本周五: 5,\n          本周六: 6,\n          本周日: 0,\n        };\n\n        const today = new Date();\n        const currentDay = today.getDay();\n        const targetDay = days[dayName];\n\n        let diff = targetDay - currentDay;\n        if (targetDay === 0) diff = 7 - currentDay;\n        if (diff <= 0) diff += 7;\n\n        const targetDate = new Date(today);\n        targetDate.setDate(today.getDate() + diff);\n\n        return `${targetDate.getMonth() + 1}.${targetDate.getDate()}`;\n      }\n\n      function getDateByOffset(offset) {\n        const date = new Date();\n        date.setDate(date.getDate() + offset);\n        return `${date.getMonth() + 1}.${date.getDate()}`;\n      }\n\n      function updateDate() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        let dateStr;\n\n        if (datePrefix.startsWith(\"本周\")) {\n          dateStr = getDateOfWeek(datePrefix);\n        } else {\n          const offset =\n            datePrefix === \"明天\" ? 1 : datePrefix === \"后天\" ? 2 : 0;\n          dateStr = getDateByOffset(offset);\n        }\n\n        document.getElementById(\"date\").value = dateStr;\n      }\n\n      function calculateTimeDifference(start, end) {\n        const [startHours, startMinutes] = start.split(\":\").map(Number);\n        const [endHours, endMinutes] = end.split(\":\").map(Number);\n\n        let diffMinutes =\n          endHours * 60 + endMinutes - (startHours * 60 + startMinutes);\n\n        // 如果结束时间小于开始时间，假设跨天，加24小时\n        if (diffMinutes < 0) {\n          diffMinutes += 24 * 60;\n        }\n\n        return diffMinutes;\n      }\n\n      function generateMessage() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        const date = document.getElementById(\"date\").value;\n        const shift = document.getElementById(\"shift\").value;\n        const name = document.getElementById(\"name\").value;\n        const leaveType = document.getElementById(\"leaveType\").value;\n\n        if (!selectedPosition || !name) {\n          alert(\"请填写完整信息！\");\n          return;\n        }\n\n        let message = `请假：${datePrefix}（${date}）${shift} ${selectedPosition} ${name} ${leaveType}`;\n\n        if (leaveType === \"临时请假\") {\n          const startTime = document.getElementById(\"startTime\").value;\n          const endTime = document.getElementById(\"endTime\").value;\n          if (!startTime || !endTime) {\n            alert(\"请填写临时请假时间！\");\n            return;\n          }\n          const diffMinutes = calculateTimeDifference(startTime, endTime);\n          message += ` ${diffMinutes}mins (${startTime}-${endTime})`;\n        }\n\n        const resultDiv = document.getElementById(\"result\");\n        resultDiv.innerHTML = `\n          <div class=\"result\">\n            <p>生成的信息：</p>\n            <p>${message}</p>\n          </div>\n          <div class=\"button-group\">\n            <button onclick=\"copyToClipboard('${message}')\" class=\"copy-button\">复制到剪贴板</button>\n          </div>\n        `;\n\n        resultDiv.scrollIntoView({ behavior: \"smooth\" });\n      }\n\n      function copyToClipboard(text) {\n        navigator.clipboard\n          .writeText(text)\n          .then(() => {\n            alert(\"已复制到剪贴板！\");\n          })\n          .catch((err) => {\n            alert(\"复制失败，请手动复制。\");\n            console.error(\"复制失败:\", err);\n          });\n      }\n\n      window.onload = function () {\n        updateDate();\n        initializePositionGrid();\n        toggleTempTimeGroup();\n      };\n    </script>\n  </body>\n</html>\n","date":"2025-04-22T05:22:00.798Z","updated":"2025-04-22T05:22:00.798Z","path":"qjsc/index.html","_id":"cm957mm90000ap0no1e0l89se","title":"","comments":true,"content":"\n<!DOCTYPE html>\n<html lang=\"zh\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"\n    />\n    <title>公寓岗小助手</title>\n    <style>\n      * {\n        box-sizing: border-box;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      body {\n        font-family: system-ui, -apple-system, sans-serif;\n        margin: 0;\n        padding: 16px;\n        background-color: #f5f5f5;\n        font-size: 16px;\n      }\n\n      .container {\n        max-width: 600px;\n        margin: 0 auto;\n        background-color: #ffffff;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      /* 新增常用链接样式 */\n      .quick-links {\n        display: flex;\n        gap: 12px;\n        margin-bottom: 24px;\n      }\n\n      .quick-link-btn {\n        flex: 1;\n        padding: 14px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        background-color: #2196f3;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n\n      .quick-link-btn:active {\n        background-color: #1976d2;\n      }\n\n      h2 {\n        text-align: center;\n        margin: 0 0 24px 0;\n        color: #333;\n        font-size: 1.5rem;\n      }\n\n      .form-group {\n        margin-bottom: 20px;\n      }\n\n      .time-group {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n      }\n\n      .time-group span {\n        color: #666;\n        font-weight: 600;\n      }\n\n      .time-input {\n        flex: 1;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        background-color: #fff;\n      }\n\n      .time-input:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      label {\n        display: block;\n        margin-bottom: 8px;\n        font-weight: 600;\n        color: #444;\n        font-size: 1rem;\n      }\n\n      select,\n      input {\n        width: 100%;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        appearance: none;\n        -webkit-appearance: none;\n        background-color: #fff;\n      }\n\n      select {\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n        background-repeat: no-repeat;\n        background-position: right 12px center;\n        background-size: 16px;\n        padding-right: 40px;\n      }\n\n      input:focus,\n      select:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      #date {\n        background-color: #f8f8f8;\n        color: #666;\n      }\n\n      .button-group {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        margin-top: 24px;\n      }\n\n      button {\n        width: 100%;\n        padding: 16px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        cursor: pointer;\n        transition: all 0.2s;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      .generate-btn {\n        background-color: #2196f3;\n      }\n\n      .generate-btn:active {\n        background-color: #1976d2;\n      }\n\n      .copy-button {\n        background-color: #4caf50;\n      }\n\n      .copy-button:active {\n        background-color: #45a049;\n      }\n\n      .position-grid {\n        display: grid;\n        grid-template-columns: repeat(6, 1fr);\n        gap: 8px;\n        margin-top: 8px;\n      }\n\n      .position-btn {\n        padding: 12px 4px;\n        background-color: #f0f0f0;\n        color: #333;\n        font-size: 0.9rem;\n        font-weight: normal;\n      }\n\n      .position-btn.selected {\n        background-color: #2196f3;\n        color: white;\n      }\n\n      .result {\n        margin-top: 24px;\n        padding: 16px;\n        background-color: #f8f8f8;\n        border-radius: 8px;\n        word-break: break-all;\n      }\n\n      .result p {\n        margin: 8px 0;\n        line-height: 1.5;\n      }\n\n      .result p:last-child {\n        font-size: 1.1rem;\n        font-weight: 600;\n        color: #333;\n      }\n\n      .fixed-bottom {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 12px 16px;\n        background-color: #fff;\n        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      .bottom-spacing {\n        height: 80px;\n      }\n\n      .selected-position {\n        margin-top: 12px;\n        padding: 8px;\n        background-color: #e3f2fd;\n        border-radius: 4px;\n        text-align: center;\n        font-weight: bold;\n        color: #1976d2;\n      }\n\n      #tempTimeGroup {\n        display: none;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"container\">\n      <h2>主管常用表格</h2>\n\n      <!-- 新增常用链接栏目 -->\n      <div class=\"quick-links\">\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVUhRTGJKS3hTdkFx'\"\n        >\n          排班表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS2poZEhocEFEb1pS?tab=zwbgiy'\"\n        >\n          空岗表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVVpLd0ZTRnhLa1Fz'\"\n        >\n          裸辞表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS0pWdlRvRkl0bG5Q'\"\n        >\n          黑名单\n        </button>\n      </div>\n      <h2>请假信息生成器</h2>\n      <div class=\"form-group\">\n        <label>日期标记</label>\n        <select id=\"datePrefix\" onchange=\"updateDate()\">\n          <option value=\"今天\">今天</option>\n          <option value=\"明天\">明天</option>\n          <option value=\"后天\">后天</option>\n          <option value=\"本周一\">周一</option>\n          <option value=\"本周二\">周二</option>\n          <option value=\"本周三\">周三</option>\n          <option value=\"本周四\">周四</option>\n          <option value=\"本周五\">周五</option>\n          <option value=\"本周六\">周六</option>\n          <option value=\"本周日\">周日</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>具体日期</label>\n        <input type=\"text\" id=\"date\" readonly />\n      </div>\n      <div class=\"form-group\">\n        <label>班次</label>\n        <select id=\"shift\">\n          <option value=\"早班\">早班</option>\n          <option value=\"午班\">午班</option>\n          <option value=\"晚班\">晚班</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>楼栋号</label>\n        <div id=\"position-grid\" class=\"position-grid\"></div>\n        <div id=\"selected-position\" class=\"selected-position\">请选择楼栋号</div>\n      </div>\n      <div class=\"form-group\">\n        <label>姓名</label>\n        <input type=\"text\" id=\"name\" placeholder=\"请输入姓名\" />\n      </div>\n      <div class=\"form-group\">\n        <label>请假类型</label>\n        <select id=\"leaveType\" onchange=\"toggleTempTimeGroup()\">\n          <option value=\"请假\">请假</option>\n          <option value=\"请假不当\">请假不当</option>\n          <option value=\"接班\">接班</option>\n          <option value=\"临时请假\">临时请假</option>\n        </select>\n      </div>\n      <div id=\"tempTimeGroup\" class=\"form-group\">\n        <label>临时请假时间</label>\n        <div class=\"time-group\">\n          <input type=\"time\" id=\"startTime\" class=\"time-input\" />\n          <span>至</span>\n          <input type=\"time\" id=\"endTime\" class=\"time-input\" />\n        </div>\n      </div>\n      <div id=\"result\"></div>\n      <div class=\"bottom-spacing\"></div>\n    </div>\n\n    <div class=\"fixed-bottom\">\n      <div class=\"button-group\">\n        <button class=\"generate-btn\" onclick=\"generateMessage()\">\n          生成请假信息\n        </button>\n      </div>\n    </div>\n\n    <script>\n      let selectedPosition = \"\";\n\n      function initializePositionGrid() {\n        const grid = document.getElementById(\"position-grid\");\n        for (let i = 1; i <= 27; i++) {\n          if (i === 5) {\n            const buttonA = document.createElement(\"button\");\n            const buttonB = document.createElement(\"button\");\n            buttonA.textContent = \"5A#\";\n            buttonB.textContent = \"5B#\";\n            buttonA.className = \"position-btn\";\n            buttonB.className = \"position-btn\";\n            buttonA.onclick = () => selectPosition(\"5A#\");\n            buttonB.onclick = () => selectPosition(\"5B#\");\n            grid.appendChild(buttonA);\n            grid.appendChild(buttonB);\n          } else {\n            const button = document.createElement(\"button\");\n            button.textContent = `${i}#`;\n            button.className = \"position-btn\";\n            button.onclick = () => selectPosition(`${i}#`);\n            grid.appendChild(button);\n          }\n        }\n      }\n\n      function toggleTempTimeGroup() {\n        const leaveType = document.getElementById(\"leaveType\").value;\n        const tempTimeGroup = document.getElementById(\"tempTimeGroup\");\n        tempTimeGroup.style.display =\n          leaveType === \"临时请假\" ? \"block\" : \"none\";\n      }\n\n      function selectPosition(position) {\n        selectedPosition = position;\n        document.querySelectorAll(\".position-btn\").forEach((btn) => {\n          btn.classList.remove(\"selected\");\n          if (btn.textContent === position) {\n            btn.classList.add(\"selected\");\n          }\n        });\n        document.getElementById(\n          \"selected-position\"\n        ).textContent = `已选择: ${position}`;\n      }\n\n      function getDateOfWeek(dayName) {\n        const days = {\n          本周一: 1,\n          本周二: 2,\n          本周三: 3,\n          本周四: 4,\n          本周五: 5,\n          本周六: 6,\n          本周日: 0,\n        };\n\n        const today = new Date();\n        const currentDay = today.getDay();\n        const targetDay = days[dayName];\n\n        let diff = targetDay - currentDay;\n        if (targetDay === 0) diff = 7 - currentDay;\n        if (diff <= 0) diff += 7;\n\n        const targetDate = new Date(today);\n        targetDate.setDate(today.getDate() + diff);\n\n        return `${targetDate.getMonth() + 1}.${targetDate.getDate()}`;\n      }\n\n      function getDateByOffset(offset) {\n        const date = new Date();\n        date.setDate(date.getDate() + offset);\n        return `${date.getMonth() + 1}.${date.getDate()}`;\n      }\n\n      function updateDate() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        let dateStr;\n\n        if (datePrefix.startsWith(\"本周\")) {\n          dateStr = getDateOfWeek(datePrefix);\n        } else {\n          const offset =\n            datePrefix === \"明天\" ? 1 : datePrefix === \"后天\" ? 2 : 0;\n          dateStr = getDateByOffset(offset);\n        }\n\n        document.getElementById(\"date\").value = dateStr;\n      }\n\n      function calculateTimeDifference(start, end) {\n        const [startHours, startMinutes] = start.split(\":\").map(Number);\n        const [endHours, endMinutes] = end.split(\":\").map(Number);\n\n        let diffMinutes =\n          endHours * 60 + endMinutes - (startHours * 60 + startMinutes);\n\n        // 如果结束时间小于开始时间，假设跨天，加24小时\n        if (diffMinutes < 0) {\n          diffMinutes += 24 * 60;\n        }\n\n        return diffMinutes;\n      }\n\n      function generateMessage() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        const date = document.getElementById(\"date\").value;\n        const shift = document.getElementById(\"shift\").value;\n        const name = document.getElementById(\"name\").value;\n        const leaveType = document.getElementById(\"leaveType\").value;\n\n        if (!selectedPosition || !name) {\n          alert(\"请填写完整信息！\");\n          return;\n        }\n\n        let message = `请假：${datePrefix}（${date}）${shift} ${selectedPosition} ${name} ${leaveType}`;\n\n        if (leaveType === \"临时请假\") {\n          const startTime = document.getElementById(\"startTime\").value;\n          const endTime = document.getElementById(\"endTime\").value;\n          if (!startTime || !endTime) {\n            alert(\"请填写临时请假时间！\");\n            return;\n          }\n          const diffMinutes = calculateTimeDifference(startTime, endTime);\n          message += ` ${diffMinutes}mins (${startTime}-${endTime})`;\n        }\n\n        const resultDiv = document.getElementById(\"result\");\n        resultDiv.innerHTML = `\n          <div class=\"result\">\n            <p>生成的信息：</p>\n            <p>${message}</p>\n          </div>\n          <div class=\"button-group\">\n            <button onclick=\"copyToClipboard('${message}')\" class=\"copy-button\">复制到剪贴板</button>\n          </div>\n        `;\n\n        resultDiv.scrollIntoView({ behavior: \"smooth\" });\n      }\n\n      function copyToClipboard(text) {\n        navigator.clipboard\n          .writeText(text)\n          .then(() => {\n            alert(\"已复制到剪贴板！\");\n          })\n          .catch((err) => {\n            alert(\"复制失败，请手动复制。\");\n            console.error(\"复制失败:\", err);\n          });\n      }\n\n      window.onload = function () {\n        updateDate();\n        initializePositionGrid();\n        toggleTempTimeGroup();\n      };\n    </script>\n  </body>\n</html>\n","cover":false,"excerpt":"","more":"\n<!DOCTYPE html>\n<html lang=\"zh\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"\n    />\n    <title>公寓岗小助手</title>\n    <style>\n      * {\n        box-sizing: border-box;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      body {\n        font-family: system-ui, -apple-system, sans-serif;\n        margin: 0;\n        padding: 16px;\n        background-color: #f5f5f5;\n        font-size: 16px;\n      }\n\n      .container {\n        max-width: 600px;\n        margin: 0 auto;\n        background-color: #ffffff;\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      /* 新增常用链接样式 */\n      .quick-links {\n        display: flex;\n        gap: 12px;\n        margin-bottom: 24px;\n      }\n\n      .quick-link-btn {\n        flex: 1;\n        padding: 14px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        background-color: #2196f3;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n\n      .quick-link-btn:active {\n        background-color: #1976d2;\n      }\n\n      h2 {\n        text-align: center;\n        margin: 0 0 24px 0;\n        color: #333;\n        font-size: 1.5rem;\n      }\n\n      .form-group {\n        margin-bottom: 20px;\n      }\n\n      .time-group {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n      }\n\n      .time-group span {\n        color: #666;\n        font-weight: 600;\n      }\n\n      .time-input {\n        flex: 1;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        background-color: #fff;\n      }\n\n      .time-input:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      label {\n        display: block;\n        margin-bottom: 8px;\n        font-weight: 600;\n        color: #444;\n        font-size: 1rem;\n      }\n\n      select,\n      input {\n        width: 100%;\n        padding: 12px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 1rem;\n        appearance: none;\n        -webkit-appearance: none;\n        background-color: #fff;\n      }\n\n      select {\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n        background-repeat: no-repeat;\n        background-position: right 12px center;\n        background-size: 16px;\n        padding-right: 40px;\n      }\n\n      input:focus,\n      select:focus {\n        outline: none;\n        border-color: #2196f3;\n      }\n\n      #date {\n        background-color: #f8f8f8;\n        color: #666;\n      }\n\n      .button-group {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        margin-top: 24px;\n      }\n\n      button {\n        width: 100%;\n        padding: 16px;\n        border: none;\n        border-radius: 8px;\n        font-size: 1rem;\n        font-weight: 600;\n        color: white;\n        cursor: pointer;\n        transition: all 0.2s;\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      .generate-btn {\n        background-color: #2196f3;\n      }\n\n      .generate-btn:active {\n        background-color: #1976d2;\n      }\n\n      .copy-button {\n        background-color: #4caf50;\n      }\n\n      .copy-button:active {\n        background-color: #45a049;\n      }\n\n      .position-grid {\n        display: grid;\n        grid-template-columns: repeat(6, 1fr);\n        gap: 8px;\n        margin-top: 8px;\n      }\n\n      .position-btn {\n        padding: 12px 4px;\n        background-color: #f0f0f0;\n        color: #333;\n        font-size: 0.9rem;\n        font-weight: normal;\n      }\n\n      .position-btn.selected {\n        background-color: #2196f3;\n        color: white;\n      }\n\n      .result {\n        margin-top: 24px;\n        padding: 16px;\n        background-color: #f8f8f8;\n        border-radius: 8px;\n        word-break: break-all;\n      }\n\n      .result p {\n        margin: 8px 0;\n        line-height: 1.5;\n      }\n\n      .result p:last-child {\n        font-size: 1.1rem;\n        font-weight: 600;\n        color: #333;\n      }\n\n      .fixed-bottom {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 12px 16px;\n        background-color: #fff;\n        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);\n      }\n\n      .bottom-spacing {\n        height: 80px;\n      }\n\n      .selected-position {\n        margin-top: 12px;\n        padding: 8px;\n        background-color: #e3f2fd;\n        border-radius: 4px;\n        text-align: center;\n        font-weight: bold;\n        color: #1976d2;\n      }\n\n      #tempTimeGroup {\n        display: none;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"container\">\n      <h2>主管常用表格</h2>\n\n      <!-- 新增常用链接栏目 -->\n      <div class=\"quick-links\">\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVUhRTGJKS3hTdkFx'\"\n        >\n          排班表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS2poZEhocEFEb1pS?tab=zwbgiy'\"\n        >\n          空岗表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DVVpLd0ZTRnhLa1Fz'\"\n        >\n          裸辞表\n        </button>\n        <button\n          class=\"quick-link-btn\"\n          onclick=\"window.location.href='https://docs.qq.com/sheet/DS0pWdlRvRkl0bG5Q'\"\n        >\n          黑名单\n        </button>\n      </div>\n      <h2>请假信息生成器</h2>\n      <div class=\"form-group\">\n        <label>日期标记</label>\n        <select id=\"datePrefix\" onchange=\"updateDate()\">\n          <option value=\"今天\">今天</option>\n          <option value=\"明天\">明天</option>\n          <option value=\"后天\">后天</option>\n          <option value=\"本周一\">周一</option>\n          <option value=\"本周二\">周二</option>\n          <option value=\"本周三\">周三</option>\n          <option value=\"本周四\">周四</option>\n          <option value=\"本周五\">周五</option>\n          <option value=\"本周六\">周六</option>\n          <option value=\"本周日\">周日</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>具体日期</label>\n        <input type=\"text\" id=\"date\" readonly />\n      </div>\n      <div class=\"form-group\">\n        <label>班次</label>\n        <select id=\"shift\">\n          <option value=\"早班\">早班</option>\n          <option value=\"午班\">午班</option>\n          <option value=\"晚班\">晚班</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>楼栋号</label>\n        <div id=\"position-grid\" class=\"position-grid\"></div>\n        <div id=\"selected-position\" class=\"selected-position\">请选择楼栋号</div>\n      </div>\n      <div class=\"form-group\">\n        <label>姓名</label>\n        <input type=\"text\" id=\"name\" placeholder=\"请输入姓名\" />\n      </div>\n      <div class=\"form-group\">\n        <label>请假类型</label>\n        <select id=\"leaveType\" onchange=\"toggleTempTimeGroup()\">\n          <option value=\"请假\">请假</option>\n          <option value=\"请假不当\">请假不当</option>\n          <option value=\"接班\">接班</option>\n          <option value=\"临时请假\">临时请假</option>\n        </select>\n      </div>\n      <div id=\"tempTimeGroup\" class=\"form-group\">\n        <label>临时请假时间</label>\n        <div class=\"time-group\">\n          <input type=\"time\" id=\"startTime\" class=\"time-input\" />\n          <span>至</span>\n          <input type=\"time\" id=\"endTime\" class=\"time-input\" />\n        </div>\n      </div>\n      <div id=\"result\"></div>\n      <div class=\"bottom-spacing\"></div>\n    </div>\n\n    <div class=\"fixed-bottom\">\n      <div class=\"button-group\">\n        <button class=\"generate-btn\" onclick=\"generateMessage()\">\n          生成请假信息\n        </button>\n      </div>\n    </div>\n\n    <script>\n      let selectedPosition = \"\";\n\n      function initializePositionGrid() {\n        const grid = document.getElementById(\"position-grid\");\n        for (let i = 1; i <= 27; i++) {\n          if (i === 5) {\n            const buttonA = document.createElement(\"button\");\n            const buttonB = document.createElement(\"button\");\n            buttonA.textContent = \"5A#\";\n            buttonB.textContent = \"5B#\";\n            buttonA.className = \"position-btn\";\n            buttonB.className = \"position-btn\";\n            buttonA.onclick = () => selectPosition(\"5A#\");\n            buttonB.onclick = () => selectPosition(\"5B#\");\n            grid.appendChild(buttonA);\n            grid.appendChild(buttonB);\n          } else {\n            const button = document.createElement(\"button\");\n            button.textContent = `${i}#`;\n            button.className = \"position-btn\";\n            button.onclick = () => selectPosition(`${i}#`);\n            grid.appendChild(button);\n          }\n        }\n      }\n\n      function toggleTempTimeGroup() {\n        const leaveType = document.getElementById(\"leaveType\").value;\n        const tempTimeGroup = document.getElementById(\"tempTimeGroup\");\n        tempTimeGroup.style.display =\n          leaveType === \"临时请假\" ? \"block\" : \"none\";\n      }\n\n      function selectPosition(position) {\n        selectedPosition = position;\n        document.querySelectorAll(\".position-btn\").forEach((btn) => {\n          btn.classList.remove(\"selected\");\n          if (btn.textContent === position) {\n            btn.classList.add(\"selected\");\n          }\n        });\n        document.getElementById(\n          \"selected-position\"\n        ).textContent = `已选择: ${position}`;\n      }\n\n      function getDateOfWeek(dayName) {\n        const days = {\n          本周一: 1,\n          本周二: 2,\n          本周三: 3,\n          本周四: 4,\n          本周五: 5,\n          本周六: 6,\n          本周日: 0,\n        };\n\n        const today = new Date();\n        const currentDay = today.getDay();\n        const targetDay = days[dayName];\n\n        let diff = targetDay - currentDay;\n        if (targetDay === 0) diff = 7 - currentDay;\n        if (diff <= 0) diff += 7;\n\n        const targetDate = new Date(today);\n        targetDate.setDate(today.getDate() + diff);\n\n        return `${targetDate.getMonth() + 1}.${targetDate.getDate()}`;\n      }\n\n      function getDateByOffset(offset) {\n        const date = new Date();\n        date.setDate(date.getDate() + offset);\n        return `${date.getMonth() + 1}.${date.getDate()}`;\n      }\n\n      function updateDate() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        let dateStr;\n\n        if (datePrefix.startsWith(\"本周\")) {\n          dateStr = getDateOfWeek(datePrefix);\n        } else {\n          const offset =\n            datePrefix === \"明天\" ? 1 : datePrefix === \"后天\" ? 2 : 0;\n          dateStr = getDateByOffset(offset);\n        }\n\n        document.getElementById(\"date\").value = dateStr;\n      }\n\n      function calculateTimeDifference(start, end) {\n        const [startHours, startMinutes] = start.split(\":\").map(Number);\n        const [endHours, endMinutes] = end.split(\":\").map(Number);\n\n        let diffMinutes =\n          endHours * 60 + endMinutes - (startHours * 60 + startMinutes);\n\n        // 如果结束时间小于开始时间，假设跨天，加24小时\n        if (diffMinutes < 0) {\n          diffMinutes += 24 * 60;\n        }\n\n        return diffMinutes;\n      }\n\n      function generateMessage() {\n        const datePrefix = document.getElementById(\"datePrefix\").value;\n        const date = document.getElementById(\"date\").value;\n        const shift = document.getElementById(\"shift\").value;\n        const name = document.getElementById(\"name\").value;\n        const leaveType = document.getElementById(\"leaveType\").value;\n\n        if (!selectedPosition || !name) {\n          alert(\"请填写完整信息！\");\n          return;\n        }\n\n        let message = `请假：${datePrefix}（${date}）${shift} ${selectedPosition} ${name} ${leaveType}`;\n\n        if (leaveType === \"临时请假\") {\n          const startTime = document.getElementById(\"startTime\").value;\n          const endTime = document.getElementById(\"endTime\").value;\n          if (!startTime || !endTime) {\n            alert(\"请填写临时请假时间！\");\n            return;\n          }\n          const diffMinutes = calculateTimeDifference(startTime, endTime);\n          message += ` ${diffMinutes}mins (${startTime}-${endTime})`;\n        }\n\n        const resultDiv = document.getElementById(\"result\");\n        resultDiv.innerHTML = `\n          <div class=\"result\">\n            <p>生成的信息：</p>\n            <p>${message}</p>\n          </div>\n          <div class=\"button-group\">\n            <button onclick=\"copyToClipboard('${message}')\" class=\"copy-button\">复制到剪贴板</button>\n          </div>\n        `;\n\n        resultDiv.scrollIntoView({ behavior: \"smooth\" });\n      }\n\n      function copyToClipboard(text) {\n        navigator.clipboard\n          .writeText(text)\n          .then(() => {\n            alert(\"已复制到剪贴板！\");\n          })\n          .catch((err) => {\n            alert(\"复制失败，请手动复制。\");\n            console.error(\"复制失败:\", err);\n          });\n      }\n\n      window.onload = function () {\n        updateDate();\n        initializePositionGrid();\n        toggleTempTimeGroup();\n      };\n    </script>\n  </body>\n</html>\n","permalink":"https://www.holiofox.space/qjsc/","full_source":"C:\\blog\\source\\qjsc\\index.html"}